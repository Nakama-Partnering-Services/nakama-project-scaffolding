parameters:
    - name: TARGET_ORG
      type: string
    - name: PACKAGE_VERSION_ID
      type: string
    - name: INSTALLATION_KEY
      type: string

steps:
    - script: |
          if [ "${{ parameters.INSTALLATION_KEY }}" != "false" ]; then
              INSTALLATION_KEY_FLAG="--installation-key ${{ parameters.INSTALLATION_KEY }}"
          fi
          sf nakama install package -o ${{ parameters.TARGET_ORG }} -p ${{ parameters.PACKAGE_VERSION_ID }} $INSTALLATION_KEY_FLAG --no-prompt --apex-compile package --security-type AdminsOnly
      displayName: 'Install package in ${{ parameters.TARGET_ORG }}'
      env:
          INT_SFDX_AUTH_URL: $(INT_SFDX_AUTH_URL)
          # QA_SFDX_AUTH_URL: $(QA_SFDX_AUTH_URL)
          # UAT_SFDX_AUTH_URL: $(QA_SFDX_AUTH_URL)
          # TODO: add lower environments
